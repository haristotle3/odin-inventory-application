<!DOCTYPE html>
<html lang="en">
<head>
  <%- include("head") %>
</head>
<body>
  <%- include("header") %>
  <main>
    <form action="/pokemon" method="GET">
      <label for="type">Type:</label>
      <select name="type" id="type">
        <option value="None" <%= selected === "None" ? 'selected' : '' %> >None</option>
        <% pokemonTypes.forEach((row) => { %>
        <option value="<%=row.type%>" <%= selected === row.type ? "selected" : "" %> ><%=row.type %></option>
        <% }); %>
      </select>
  
      <label for="trainerID">Trainer ID:</label>
      <select name="trainerID" id="trainerID">
        <option value="None">None</option>
        <% trainerIDsNames.forEach((row) => { %>
        <option value="<%=row.id %>"><%=row.id %></option>
        <% }); %>
      </select>
  
      <input type="submit" value="Apply Filter">
    </form>

    <form action="/pokemon" method="GET">
      <label for="search">Search</label>
      <input type="text" name="search" id="search">
      <input type="submit" value="Search">
    </form>

    <button id="openDialogButton">Add Pokemon</button>

    <dialog id="addPokemonDialog">
      <form action="/pokemon" method="POST" enctype="multipart/form-data">
        <label for="name">Name: </label>
        <input name="name" type="text" id="name">
  
        <label for="type">Type: </label>
        <input name="type" type="text" id="type">
  
        <label for="description">Description: </label>
        <textarea name="description" id="description"></textarea>
  
        <label for="trainerID">Trainer ID:</label>
        <select name="trainerID" id="trainerID">
          <% trainerIDsNames.forEach((row) => { %>
          <option value="<%=row.id %>"><%=row.name %> (#<%=row.id %>)</option>
          <% }); %>
        </select>
  
        <label for="photo">Photo</label>
        <input name="photo" type="file" accept="image/png">
  
        <input type="submit" value="Add Pokemon">
      </form>
    </dialog>

    <ul class="pokemons">
      <% pokemon.forEach((pm) => { %>
      <li class="pokemon">
        <a href="/pokemon/<%= pm.id %>" class="pokemon-card-link">
          <ul class="pokemon-details">
            <li>
              <img
                src="<%= pm.image_path %>"
                alt="Image of <%= pm.name %>"
              />
            </li>
            <li class="pokemon-name"><%= pm.name %></li>
            <li class="pokemon-type"><%= pm.type %></li>
            <li class="pokemon-trainer-id"><%= pm.trainer_id %></li>
            <li class="pokemon-description"><%= pm.description %></li>
          </ul>
        </a>
      </li>
      <% }) %>
    </ul>
    
    <script>
      const openDialogButton = document.getElementById("openDialogButton");
      const dialog = document.getElementById("addPokemonDialog")
  
      openDialogButton.addEventListener("click", () => {
        dialog.showModal();
      })
    </script>

    <script src="https://cdn.jsdelivr.net/gh/rick-liruixin/body-scroll-lock-upgrade@v1.1.0/lib/index.umd.js"></script>
    <script src="/headerScript.js"></script>
  </main>
</body>
</html>

